<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://docs.ncronjob.dev/features/instant-jobs/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Triggering instant jobs - NCronJob</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Triggering instant jobs";
        var mkdocs_page_input_path = "features/instant-jobs.md";
        var mkdocs_page_url = "/features/instant-jobs/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../..">
          <img src="../../logo_small.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">NCronJob</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Overview</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting-started/">Getting Started</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Features</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../define-and-schedule-jobs/">Define and Schedule Jobs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../parameters/">Passing Parameters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notifications/">Notifications</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../multiple-cron-expressions/">Registering multiple CRON expressions</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Triggering instant jobs</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#starting-a-job-with-a-delay">Starting a job with a delay</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#starting-a-job-at-a-specific-date-and-time">Starting a job at a specific date and time</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#priority">Priority</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#force-a-job-run">Force a job run</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#minimal-api">Minimal API</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#triggering-executions-of-named-orchestrations">Triggering executions of named orchestrations</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#precautions-of-use">Precautions of use</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#instrumentation">Instrumentation</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../concurrency-control/">Concurrency control</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../retry-support/">Retry support</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../minimal-api/">Minimal API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../startup-jobs/">Startup Jobs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../model-dependencies/">Model dependencies</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../exception-handler/">Exception handler</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Migration</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../migration/v4/">v4 Migration Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../migration/v3/">v3 Migration Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../migration/v2/">v2 Migration Guide</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced/log-level/">Controlling the log level</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced/global-concurrency/">Global Concurrency</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced/dynamic-job-control/">Dynamic Job Control</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced/observing-job-progress/">Observing progress of jobs</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">NCronJob</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Features</li>
      <li class="breadcrumb-item active">Triggering instant jobs</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/NCronJob-Dev/NCronJob/edit/main/docs/features/instant-jobs.md">Edit on NCronJob-Dev/NCronJob</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="triggering-instant-jobs">Triggering instant jobs<a class="headerlink" href="#triggering-instant-jobs" title="Permanent link">&para;</a></h1>
<p><strong>NCronJob</strong> allows you to trigger jobs instantly. This is useful when you want to run a job immediately without waiting for the next scheduled time. For example you get a API request and want to offload the work to a background job immediately.</p>
<p>Instant jobs are like &ldquo;regular&rdquo; CRON jobs and inherit from <code>IJob</code>. The only difference is that they are triggered manually.
So also CRON jobs can be triggered instantly.</p>
<div class="codehilite"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">MyJob</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IJob</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="nf">RunAsync</span><span class="p">(</span><span class="n">IJobExecutionContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">CancellationToken</span><span class="w"> </span><span class="n">token</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">ParameterDto</span><span class="w"> </span><span class="n">dto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ParameterDto</span><span class="p">)</span><span class="n">context</span><span class="p">.</span><span class="n">Parameter</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// Do something</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Task</span><span class="p">.</span><span class="n">CompletedTask</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>As CRON jobs, they have to be registered in the <code>AddNCronJob</code> method.</p>
<div class="codehilite"><pre><span></span><code><span class="n">Services</span><span class="p">.</span><span class="n">AddNCronJob</span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>
<span class="p">{</span>
<span class="w">    </span><span class="n">options</span><span class="p">.</span><span class="n">AddJob</span><span class="o">&lt;</span><span class="n">MyJob</span><span class="o">&gt;</span><span class="p">();</span><span class="w"> </span><span class="c1">// No need to specify a CRON expression</span>
<span class="p">});</span>
</code></pre></div>

<p>There is no need of a CRON expression for instant jobs. Also passing in parameters doesn&rsquo;t do anything, they will be passed in differently. Let&rsquo;s have a look at how to trigger an instant job. Imagine we have a Minimal API where we want to send an E-Mail:</p>
<div class="codehilite"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">MapPost</span><span class="p">(</span><span class="s">&quot;/send-email&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">RequestDto</span><span class="w"> </span><span class="n">dto</span><span class="p">,</span><span class="w"> </span><span class="n">IInstantJobRegistry</span><span class="w"> </span><span class="n">jobRegistry</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">parameterDto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ParameterDto</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span>
<span class="w">        </span><span class="n">Subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Subject</span><span class="p">,</span>
<span class="w">        </span><span class="n">Body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Body</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="n">jobRegistry</span><span class="p">.</span><span class="n">RunInstantJob</span><span class="o">&lt;</span><span class="n">MyJob</span><span class="o">&gt;</span><span class="p">(</span><span class="n">parameterDto</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Results</span><span class="p">.</span><span class="n">Ok</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>

<p>The <code>RunInstantJob</code> method takes the job type and the parameters as arguments. Optionally you can pass in a <code>CancellationToken</code> as well. The job will be executed immediately.</p>
<h2 id="starting-a-job-with-a-delay">Starting a job with a delay<a class="headerlink" href="#starting-a-job-with-a-delay" title="Permanent link">&para;</a></h2>
<p>If you find the need to delay the execution of an instant job, you can use the <code>RunScheduledJob</code> method with a <code>TimeSpan</code> as a delay. The same as <code>RunInstantJob</code> applies here, the job has to be registered in the <code>AddNCronJob</code> method.</p>
<div class="codehilite"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">MapPost</span><span class="p">(</span><span class="s">&quot;/send-email&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">RequestDto</span><span class="w"> </span><span class="n">dto</span><span class="p">,</span><span class="w"> </span><span class="n">IInstantJobRegistry</span><span class="w"> </span><span class="n">jobRegistry</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">parameterDto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ParameterDto</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span>
<span class="w">        </span><span class="n">Subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Subject</span><span class="p">,</span>
<span class="w">        </span><span class="n">Body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Body</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="n">jobRegistry</span><span class="p">.</span><span class="n">RunScheduledJob</span><span class="o">&lt;</span><span class="n">MyJob</span><span class="o">&gt;</span><span class="p">(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromMinutes</span><span class="p">(</span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="n">parameterDto</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Results</span><span class="p">.</span><span class="n">Ok</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>

<h2 id="starting-a-job-at-a-specific-date-and-time">Starting a job at a specific date and time<a class="headerlink" href="#starting-a-job-at-a-specific-date-and-time" title="Permanent link">&para;</a></h2>
<p>If you want to start a job at a specific date and time, you can use the <code>RunScheduledJob</code> method with a <code>DateTimeOffset</code> as a parameter. The same as before: The job has to be registered.</p>
<div class="codehilite"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">MapPost</span><span class="p">(</span><span class="s">&quot;/send-email&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">RequestDto</span><span class="w"> </span><span class="n">dto</span><span class="p">,</span><span class="w"> </span><span class="n">IInstantJobRegistry</span><span class="w"> </span><span class="n">jobRegistry</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">parameterDto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ParameterDto</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span>
<span class="w">        </span><span class="n">Subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Subject</span><span class="p">,</span>
<span class="w">        </span><span class="n">Body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Body</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="n">jobRegistry</span><span class="p">.</span><span class="n">RunScheduledJob</span><span class="o">&lt;</span><span class="n">MyJob</span><span class="o">&gt;</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">DateTimeOffset</span><span class="p">(</span><span class="m">2024</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromHours</span><span class="p">(</span><span class="m">2</span><span class="p">)),</span><span class="w"> </span><span class="n">parameterDto</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Results</span><span class="p">.</span><span class="n">Ok</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>

<h2 id="priority">Priority<a class="headerlink" href="#priority" title="Permanent link">&para;</a></h2>
<p>Instant jobs are executed with a higher priority than CRON jobs. This means that if you have a CRON job that is scheduled to run at the same time as an instant job, the instant job will be executed first (and if both of them are competing for the same resources, only the instant job will be executed).</p>
<h2 id="force-a-job-run">Force a job run<a class="headerlink" href="#force-a-job-run" title="Permanent link">&para;</a></h2>
<p>Sometimes you need to run a job immediately, regardless of any running jobs or concurrency settings. The <code>ForceRunInstantJob</code> methods allow you to bypass the job queue and execute a job directly.</p>
<p>While regular instant jobs follow the same concurrency rules as CRON jobs, forced jobs ignore these restrictions:</p>
<div class="codehilite"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">EmailJob</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IJob</span><span class="w"> </span>
<span class="p">{</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">IEmailService</span><span class="w"> </span><span class="n">emailService</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nf">EmailJob</span><span class="p">(</span><span class="n">IEmailService</span><span class="w"> </span><span class="n">emailService</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">emailService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">emailService</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="nf">RunAsync</span><span class="p">(</span><span class="n">IJobExecutionContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">CancellationToken</span><span class="w"> </span><span class="n">token</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="n">emailService</span><span class="p">.</span><span class="n">SendEmailAsync</span><span class="p">((</span><span class="n">EmailMessage</span><span class="p">)</span><span class="n">context</span><span class="p">.</span><span class="n">Parameter</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Normal instant job - will wait if another EmailJob is running</span>
<span class="n">app</span><span class="p">.</span><span class="n">MapPost</span><span class="p">(</span><span class="s">&quot;/send-email&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">EmailMessage</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">IInstantJobRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">registry</span><span class="p">.</span><span class="n">RunInstantJob</span><span class="o">&lt;</span><span class="n">EmailJob</span><span class="o">&gt;</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Results</span><span class="p">.</span><span class="n">Accepted</span><span class="p">();</span>
<span class="p">});</span>

<span class="c1">// Forced instant job - runs immediately even if other EmailJobs are active</span>
<span class="n">app</span><span class="p">.</span><span class="n">MapPost</span><span class="p">(</span><span class="s">&quot;/send-urgent-email&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">EmailMessage</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">IInstantJobRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">registry</span><span class="p">.</span><span class="n">ForceRunInstantJob</span><span class="o">&lt;</span><span class="n">EmailJob</span><span class="o">&gt;</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Results</span><span class="p">.</span><span class="n">Accepted</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>

<p>The force option is also available for scheduled jobs:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Normal scheduled job - follows concurrency rules</span>
<span class="n">registry</span><span class="p">.</span><span class="n">RunScheduledJob</span><span class="o">&lt;</span><span class="n">ReportJob</span><span class="o">&gt;</span><span class="p">(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromMinutes</span><span class="p">(</span><span class="m">5</span><span class="p">));</span>

<span class="c1">// Forced scheduled job - bypasses queue and concurrency limits</span>
<span class="n">registry</span><span class="p">.</span><span class="n">ForceRunScheduledJob</span><span class="o">&lt;</span><span class="n">ReportJob</span><span class="o">&gt;</span><span class="p">(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromMinutes</span><span class="p">(</span><span class="m">5</span><span class="p">));</span>
</code></pre></div>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Use forced job execution carefully as it bypasses the built-in concurrency protection. This could lead to resource contention if multiple forced jobs run simultaneously.</p>
</div>
<h2 id="minimal-api">Minimal API<a class="headerlink" href="#minimal-api" title="Permanent link">&para;</a></h2>
<p>Running instant jobs can also be done with the minimal API (<a href="../minimal-api/">Minimal API</a>), which allows to create an anonymous lambda, that can also contain dependencies.</p>
<div class="codehilite"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">MapPost</span><span class="p">(</span><span class="s">&quot;/send-email&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">RequestDto</span><span class="w"> </span><span class="n">dto</span><span class="p">,</span><span class="w"> </span><span class="n">IInstantJobRegistry</span><span class="w"> </span><span class="n">jobRegistry</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">parameterDto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ParameterDto</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span>
<span class="w">        </span><span class="n">Subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Subject</span><span class="p">,</span>
<span class="w">        </span><span class="n">Body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Body</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="n">jobRegistry</span><span class="p">.</span><span class="n">RunInstantJob</span><span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="n">HttpClient</span><span class="w"> </span><span class="n">httpClient</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="n">httpClient</span><span class="p">.</span><span class="n">PostAsync</span><span class="p">(</span><span class="s">&quot;https://api.example.com/send-email&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringContent</span><span class="p">(</span><span class="n">JsonSerializer</span><span class="p">.</span><span class="n">Serialize</span><span class="p">(</span><span class="n">parameterDto</span><span class="p">)));</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">TypedResults</span><span class="p">.</span><span class="n">Ok</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>

<h2 id="triggering-executions-of-named-orchestrations">Triggering executions of named orchestrations<a class="headerlink" href="#triggering-executions-of-named-orchestrations" title="Permanent link">&para;</a></h2>
<p>While registering jobs, one can give them names (See <a href="../../advanced/dynamic-job-control/#defining-job-names"><em>&ldquo;Defining job names&rdquo;</em></a>.).</p>
<p>Similarly, the <code>IInstantJobRegistry</code> methods expose overloads to target a job through its name.</p>
<p>This capability provides an escape hatch to situations as described in <a href="#precautions-of-use"><em>&ldquo;Precautions of use&rdquo;</em></a> below.</p>
<div class="codehilite"><pre><span></span><code><span class="n">Services</span><span class="p">.</span><span class="n">AddNCronJob</span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">options</span><span class="p">.</span><span class="n">AddJob</span><span class="o">&lt;</span><span class="n">GatherDataJob</span><span class="o">&gt;</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">WithCronExpression</span><span class="p">(</span><span class="s">&quot;0 0 * * *&quot;</span><span class="p">).</span><span class="n">WithName</span><span class="p">(</span><span class="s">&quot;nightly&quot;</span><span class="p">))</span>
<span class="w">        </span><span class="p">.</span><span class="n">ExecuteWhen</span><span class="p">(</span><span class="n">success</span><span class="p">:</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">RunJob</span><span class="o">&lt;</span><span class="n">SendReportToStaffJob</span><span class="o">&gt;</span><span class="p">());</span>

<span class="w">    </span><span class="n">options</span><span class="p">.</span><span class="n">AddJob</span><span class="o">&lt;</span><span class="n">GatherDataJob</span><span class="o">&gt;</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">WithCronExpression</span><span class="p">(</span><span class="s">&quot;0 0 1 * *&quot;</span><span class="p">).</span><span class="n">WithName</span><span class="p">(</span><span class="s">&quot;monthly&quot;</span><span class="p">))</span>
<span class="w">        </span><span class="p">.</span><span class="n">ExecuteWhen</span><span class="p">(</span><span class="n">success</span><span class="p">:</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">RunJob</span><span class="o">&lt;</span><span class="n">SendReportToManagementJob</span><span class="o">&gt;</span><span class="p">());</span>
<span class="p">});</span>

<span class="n">app</span><span class="p">.</span><span class="n">MapPost</span><span class="p">(</span><span class="s">&quot;/on-demand-report&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">IInstantJobRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">registry</span><span class="p">.</span><span class="n">RunInstantJob</span><span class="p">(</span><span class="s">&quot;nightly&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Results</span><span class="p">.</span><span class="n">Accepted</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>

<h2 id="precautions-of-use">Precautions of use<a class="headerlink" href="#precautions-of-use" title="Permanent link">&para;</a></h2>
<p>Depending of the way jobs are designed and registered, it may happen that <strong>NCronJob</strong> cannot uniquely identify the intended target of a instant run.</p>
<p>In that case, rather than accidently running the wrong job, a runtime exception will be thrown stating that than an ambiguity has been detected.</p>
<div class="codehilite"><pre><span></span><code><span class="n">Services</span><span class="p">.</span><span class="n">AddNCronJob</span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">options</span><span class="p">.</span><span class="n">AddJob</span><span class="o">&lt;</span><span class="n">GatherDataJob</span><span class="o">&gt;</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">WithCronExpression</span><span class="p">(</span><span class="s">&quot;0 0 * * *&quot;</span><span class="p">))</span><span class="w"> </span><span class="c1">// Every day at midnight</span>
<span class="w">        </span><span class="p">.</span><span class="n">ExecuteWhen</span><span class="p">(</span><span class="n">success</span><span class="p">:</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">RunJob</span><span class="o">&lt;</span><span class="n">SendReportToStaffJob</span><span class="o">&gt;</span><span class="p">());</span>

<span class="w">    </span><span class="n">options</span><span class="p">.</span><span class="n">AddJob</span><span class="o">&lt;</span><span class="n">GatherDataJob</span><span class="o">&gt;</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">WithCronExpression</span><span class="p">(</span><span class="s">&quot;0 0 1 * *&quot;</span><span class="p">))</span><span class="w"> </span><span class="c1">// Every first of the month at midnight</span>
<span class="w">        </span><span class="p">.</span><span class="n">ExecuteWhen</span><span class="p">(</span><span class="n">success</span><span class="p">:</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">RunJob</span><span class="o">&lt;</span><span class="n">SendReportToManagementJob</span><span class="o">&gt;</span><span class="p">());</span>
<span class="p">});</span>

<span class="n">app</span><span class="p">.</span><span class="n">MapPost</span><span class="p">(</span><span class="s">&quot;/on-demand-report&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">IInstantJobRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">registry</span><span class="p">.</span><span class="n">RunInstantJob</span><span class="o">&lt;</span><span class="n">GatherDataJob</span><span class="o">&gt;</span><span class="p">();</span><span class="w"> </span><span class="c1">// Ambiguous reference. This will throw :-/</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Results</span><span class="p">.</span><span class="n">Accepted</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>

<h2 id="instrumentation">Instrumentation<a class="headerlink" href="#instrumentation" title="Permanent link">&para;</a></h2>
<p>All members of the <code>IInstantJobRegistry</code> interface return the correlation id of the triggered job (See <a href="../model-dependencies/#tracing-requests-of-dependencies-via-correlationid"><em>&ldquo;Tracing requests of dependencies via <code>CorrelationId</code>&ldquo;</em></a>.).</p>
<div class="codehilite"><pre><span></span><code><span class="n">Guid</span><span class="w"> </span><span class="n">oneCorrelationId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jobRegistry</span><span class="p">.</span><span class="n">RunInstantJob</span><span class="o">&lt;</span><span class="n">MyJob</span><span class="o">&gt;</span><span class="p">();</span>

<span class="n">Guid</span><span class="w"> </span><span class="n">anotherCorrelationId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jobRegistry</span><span class="p">.</span><span class="n">RunScheduledJob</span><span class="o">&lt;</span><span class="n">MyJob</span><span class="o">&gt;</span><span class="p">(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromMinutes</span><span class="p">(</span><span class="m">5</span><span class="p">));</span>

<span class="na">[...]</span>
</code></pre></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../multiple-cron-expressions/" class="btn btn-neutral float-left" title="Registering multiple CRON expressions"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../concurrency-control/" class="btn btn-neutral float-right" title="Concurrency control">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>2024 <a href="https://github.com/NCronJob-Dev">NCronJob-Dev</a>.</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/NCronJob-Dev/NCronJob" class="fa fa-code-fork" style="color: #fcfcfc"> NCronJob-Dev/NCronJob</a>
        </span>
    
    
      <span><a href="../multiple-cron-expressions/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../concurrency-control/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
