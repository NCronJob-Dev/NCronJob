<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://ncronjob-dev.github.io/NCronJob/features/instant-jobs/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Triggering instant jobs - NCronJob</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Triggering instant jobs";
        var mkdocs_page_input_path = "features/instant-jobs.md";
        var mkdocs_page_url = "/NCronJob/features/instant-jobs/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../..">
          <img src="../../logo_small.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">NCronJob</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Overview</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting-started/">Getting Started</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Features</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../define-and-schedule-jobs/">Define and Schedule Jobs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../parameters/">Passing Parameters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notifications/">Notifications</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../multiple-cron-expressions/">Registering multiple CRON expressions</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Triggering instant jobs</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#starting-a-job-with-a-delay">Starting a job with a delay</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#starting-a-job-at-a-specific-date-and-time">Starting a job at a specific date and time</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#priority">Priority</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../concurrency-control/">Concurrency control</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../retry-support/">Retry support</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../minimal-api/">Minimal API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../startup-jobs/">Startup Jobs</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Migration</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../migration/v2/">v2 Migration Guide</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced/log-level/">Controlling the log level</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced/global-concurrency/">Global Concurrency</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">NCronJob</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Features</li>
      <li class="breadcrumb-item active">Triggering instant jobs</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/NCronJob-Dev/NCronJob/edit/main/docs/features/instant-jobs.md">Edit on NCronJob-Dev/NCronJob</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="triggering-instant-jobs">Triggering instant jobs<a class="headerlink" href="#triggering-instant-jobs" title="Permanent link">&para;</a></h1>
<p><strong>NCronJob</strong> allows you to trigger jobs instantly. This is useful when you want to run a job immediately without waiting for the next scheduled time. For example you get a API request and want to offload the work to a background job immediately.</p>
<p>Instant jobs are like &ldquo;regular&rdquo; CRON jobs and inherit from <code>IJob</code>. The only difference is that they are triggered manually.
So also CRON jobs can be triggered instantly.</p>
<div class="codehilite"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">MyJob</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IJob</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="nf">RunAsync</span><span class="p">(</span><span class="n">JobExecutionContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">CancellationToken</span><span class="w"> </span><span class="n">token</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">ParameterDto</span><span class="w"> </span><span class="n">dto</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">ParameterDto</span><span class="p">)</span><span class="n">context</span><span class="p">.</span><span class="n">Parameter</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Do something</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Task</span><span class="p">.</span><span class="n">CompletedTask</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>As CRON jobs, they have to be registered in the <code>AddNCronJob</code> method.</p>
<div class="codehilite"><pre><span></span><code><span class="n">Services</span><span class="p">.</span><span class="n">AddNCronJob</span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">options</span><span class="p">.</span><span class="n">AddJob</span><span class="p">&lt;</span><span class="n">MyJob</span><span class="p">&gt;();</span><span class="w"> </span><span class="c1">// No need to specify a CRON expression</span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>

<p>There is no need of a CRON expression for instant jobs. Also passing in parameters doesn&rsquo;t do anything, they will be passed in differently. Let&rsquo;s have a look at how to trigger an instant job. Imagine we have a Minimal API where we want to send an E-Mail:</p>
<div class="codehilite"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">MapPost</span><span class="p">(</span><span class="s">&quot;/send-email&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">RequestDto</span><span class="w"> </span><span class="n">dto</span><span class="p">,</span><span class="w"> </span><span class="n">IInstantJobRegistry</span><span class="w"> </span><span class="n">jobRegistry</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">parameterDto</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ParameterDto</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Email</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">Subject</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Subject</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">Body</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Body</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="n">jobRegistry</span><span class="p">.</span><span class="n">RunInstantJob</span><span class="p">&lt;</span><span class="n">MyJob</span><span class="p">&gt;(</span><span class="n">parameterDto</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Results</span><span class="p">.</span><span class="n">Ok</span><span class="p">();</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>

<p>The <code>RunInstantJob</code> method takes the job type and the parameters as arguments. Optionally you can pass in a <code>CancellationToken</code> as well. The job will be executed immediately.</p>
<h2 id="starting-a-job-with-a-delay">Starting a job with a delay<a class="headerlink" href="#starting-a-job-with-a-delay" title="Permanent link">&para;</a></h2>
<p>If you find the need of delaying the execution of an instant job, you can use the <code>RunScheduledJob</code> method with a <code>TimeSpan</code> as a delay. The same as <code>RunInstantJob</code> applies here, the job has to be registered in the <code>AddNCronJob</code> method.</p>
<div class="codehilite"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">MapPost</span><span class="p">(</span><span class="s">&quot;/send-email&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">RequestDto</span><span class="w"> </span><span class="n">dto</span><span class="p">,</span><span class="w"> </span><span class="n">IInstantJobRegistry</span><span class="w"> </span><span class="n">jobRegistry</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">parameterDto</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ParameterDto</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Email</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">Subject</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Subject</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">Body</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Body</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="n">jobRegistry</span><span class="p">.</span><span class="n">RunScheduledJob</span><span class="p">&lt;</span><span class="n">MyJob</span><span class="p">&gt;(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromMinutes</span><span class="p">(</span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="n">parameterDto</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Results</span><span class="p">.</span><span class="n">Ok</span><span class="p">();</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>

<h2 id="starting-a-job-at-a-specific-date-and-time">Starting a job at a specific date and time<a class="headerlink" href="#starting-a-job-at-a-specific-date-and-time" title="Permanent link">&para;</a></h2>
<p>If you want to start a job at a specific date and time, you can use the <code>RunScheduledJob</code> method with a <code>DateTimeOffset</code> as a parameter. The same as before: The job has to be registered.</p>
<div class="codehilite"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">MapPost</span><span class="p">(</span><span class="s">&quot;/send-email&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">RequestDto</span><span class="w"> </span><span class="n">dto</span><span class="p">,</span><span class="w"> </span><span class="n">IInstantJobRegistry</span><span class="w"> </span><span class="n">jobRegistry</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">parameterDto</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ParameterDto</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Email</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Email</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">Subject</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Subject</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">Body</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dto</span><span class="p">.</span><span class="n">Body</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="n">jobRegistry</span><span class="p">.</span><span class="n">RunScheduledJob</span><span class="p">&lt;</span><span class="n">MyJob</span><span class="p">&gt;(</span><span class="k">new</span><span class="w"> </span><span class="n">DateTimeOffset</span><span class="p">(</span><span class="m">2024</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromHours</span><span class="p">(</span><span class="m">2</span><span class="p">)),</span><span class="w"> </span><span class="n">parameterDto</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Results</span><span class="p">.</span><span class="n">Ok</span><span class="p">();</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>

<h2 id="priority">Priority<a class="headerlink" href="#priority" title="Permanent link">&para;</a></h2>
<p>Instant jobs are executed with a higher priority than CRON jobs. This means that if you have a CRON job that is scheduled to run at the same time as an instant job, the instant job will be executed first (and if both of them are competing for the same resources, the instant job will be executed).</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../multiple-cron-expressions/" class="btn btn-neutral float-left" title="Registering multiple CRON expressions"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../concurrency-control/" class="btn btn-neutral float-right" title="Concurrency control">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>2024 <a href="https://github.com/NCronJob-Dev">NCronJob-Dev</a>.</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/NCronJob-Dev/NCronJob" class="fa fa-code-fork" style="color: #fcfcfc"> NCronJob-Dev/NCronJob</a>
        </span>
    
    
      <span><a href="../multiple-cron-expressions/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../concurrency-control/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
